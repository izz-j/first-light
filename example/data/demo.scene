;; -*- mode: common-lisp -*-

(in-package :gear-example)

(defun random-shots (base extra)
  (+ base (random extra)))

(scene-definition :demo (:enabled t)
  ((@camera
    ((transform :translation/current (vec 0 0 1))
     (camera :activep t
             :mode :orthographic)))

   (@player-ship
    ((transform :rotation/incremental (vec 0 0 0.01)
                :scale/current (vec 128 128 128))
     (mesh-renderer)
     (hit-points :hp 100))

    (@thing1
     ((transform :translation/current (vec 1 0 0))
      (mesh-renderer)))
    (@thing2
     ((transform :translation/current (vec 0 1 0))
      (mesh-renderer)))
    (@thing3
     ((transform :translation/current (vec -1 0 0))
      (mesh-renderer)))
    (@thing4
     ((transform :translation/current (vec 0 -1 0))
      (mesh-renderer)))

    (@turret
     ((transform)
      (gun-manager :active-gun 0
                   :guns (vector (get-component 'gun @laser)
                                 (get-component 'gun @missile))))
     (@laser
      ((transform)
       (gun :shot-count 10
            :shot-type :beam)))
     (@missile
      ((transform)
       (gun :shot-count (random-shots 5 5)
            :shot-type :homing)))))))
